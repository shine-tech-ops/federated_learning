## Regional Server 架构

### 1. 主进程 (Main Process)
- 进程管理和监控
  - 启动和管理worker进程
  - 监控进程状态
  - 进程异常重启
- 配置管理
  - 加载配置
  - 初始化数据库连接
  - 初始化消息队列连接

### 2. 任务Worker (Task Worker)
- 任务调度和执行
  - 监听RabbitMQ任务消息（新任务、状态更新、取消指令）
  - 任务优先级排队
  - 设备选择和资源评估
- 状态上报
  - 实时数据：通过RabbitMQ上报
    - 训练进度
    - 任务状态变更
    - 任务异常通知
  - 批量数据：通过HTTP API上报
    - 训练历史记录
    - 任务执行统计

### 3. 监控Worker (Monitor Worker)
- 设备监控
  - 设备心跳检测
  - 设备资源监控（CPU/内存/GPU）
  - 设备性能指标收集
- 系统监控
  - 区域节点资源监控
  - 系统性能指标
  - 异常检测
- 状态上报
  - 实时数据：通过RabbitMQ上报
    - 设备在线状态变更
    - 资源使用预警
    - 系统异常告警
  - 批量数据：通过HTTP API上报
    - 设备性能统计
    - 系统资源报告
    - 监控历史数据

### 4. 存储服务 (Storage Service)
- SQLite本地数据库
  - 任务队列记录
  - 设备状态缓存
  - 执行历史记录
- 日志文件
  - 运行日志
  - 错误日志
  - 性能日志

### 5. 通信策略
- RabbitMQ（实时数据）
  - 任务状态变更
  - 设备状态更新
  - 系统告警通知
  - 训练进度反馈
- HTTP API（批量数据）
  - 历史记录同步
  - 统计数据上报
  - 日志文件上传
  - 配置更新请求