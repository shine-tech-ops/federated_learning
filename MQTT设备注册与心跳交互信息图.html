<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>MQTT è®¾å¤‡ç®¡ç†ï¼šæ³¨å†Œä¸å¿ƒè·³</title>
    <script src="https://cdn.tailwindcss.com"></script>
    <script src="https://cdn.jsdelivr.net/npm/chart.js"></script>
    <link rel="preconnect" href="https://fonts.googleapis.com">
    <link rel="preconnect" href="https://fonts.gstatic.com" crossorigin>
    <link href="https://fonts.googleapis.com/css2?family=Noto+Sans+SC:wght@300;400;500;700&display=swap" rel="stylesheet">
    <!-- Chosen Palette: Brilliant Blues & Warm Accents -->
    <!-- Application Structure Plan: The SPA is structured with a hero section, followed by a "Why MQTT" explanation. The core is an interactive horizontal flowchart detailing the registration and heartbeat process with clickable steps for details. A section outlines component responsibilities, and it concludes with a donut chart summarizing the benefits. This structure aims to guide the user through the advantages and step-by-step implementation of MQTT for device management in FL. -->
    <!-- Visualization & Content Choices: 1. Core Process: Interactive Horizontal Flowchart (HTML/CSS + JS). Goal: Organize & Explain Process. Interaction: Clickable steps reveal detailed text. Justification: Visualizes sequential interaction clearly. NO SVG/Mermaid used. 2. Why MQTT: Feature List (HTML/CSS). Goal: Inform. Justification: Bullet points for quick readability of benefits. 3. Responsibilities: Card Layout (HTML/CSS). Goal: Inform. Justification: Categorizes roles for clarity. 4. Benefits: Donut Chart (Chart.js/Canvas). Goal: Inform (composition). Justification: Quantifies key advantages of using MQTT. Tooltips are configured and labels are wrapped as required. -->
    <!-- CONFIRMATION: NO SVG graphics used. NO Mermaid JS used. -->
    <style>
        body {
            font-family: 'Noto Sans SC', sans-serif;
            background-color: #f8fafc;
            color: #1e293b;
        }
        .flow-step-card {
            transition: transform 0.2s ease-in-out, box-shadow 0.2s ease-in-out, border-color 0.2s ease-in-out;
            cursor: pointer;
            position: relative;
            background-color: #ffffff;
            padding: 1.5rem;
            border-radius: 0.75rem;
            box-shadow: 0 4px 6px rgba(0, 0, 0, 0.1);
            border: 2px solid transparent;
            min-height: 120px;
            display: flex;
            flex-direction: column;
            justify-content: center;
        }
        .flow-step-card:hover {
            transform: translateY(-4px);
            box-shadow: 0 10px 15px -3px rgb(0 0 0 / 0.1), 0 4px 6px -4px rgb(0 0 0 / 0.1);
        }
        .flow-step-card.active {
            transform: translateY(-2px);
            border-color: #2563eb;
            box-shadow: 0 0 20px rgba(59, 130, 246, 0.5);
        }
        .step-number {
            position: absolute;
            top: -1.25rem;
            left: -1.25rem;
            background-color: #2563eb;
            color: white;
            border-radius: 9999px;
            height: 2.5rem;
            width: 2.5rem;
            display: flex;
            align-items: center;
            justify-content: center;
            font-weight: bold;
            font-size: 1.25rem;
            box-shadow: 0 2px 4px rgba(0, 0, 0, 0.2);
        }
        .details-panel {
            transition: opacity 0.4s ease-in-out, max-height 0.4s ease-in-out;
            max-height: 0;
            opacity: 0;
            overflow: hidden;
        }
        .details-panel.show {
            max-height: 1000px;
            opacity: 1;
        }
        .flow-arrow-right {
            font-size: 2.5rem;
            color: #94a3b8;
            font-weight: 300;
            text-align: center;
            margin: 0 1rem;
        }
        .flow-entity-header {
            font-weight: 600;
            font-size: 1.25rem;
            color: #475569;
            margin-bottom: 1rem;
            text-align: center;
        }
        .chart-container {
            position: relative;
            width: 100%;
            max-width: 600px;
            margin-left: auto;
            margin-right: auto;
            height: 300px;
            max-height: 400px;
        }
        @media (min-width: 768px) {
            .chart-container {
                height: 350px;
            }
        }
    </style>
</head>
<body class="antialiased">

    <main class="container mx-auto px-4 py-12 md:py-16">

        <section id="hero" class="text-center mb-16">
            <h1 class="text-4xl md:text-5xl font-extrabold mb-4 text-slate-900">è¾¹ç¼˜è®¾å¤‡ç®¡ç†ï¼šMQTT æ³¨å†Œä¸å¿ƒè·³</h1>
            <h2 class="text-2xl md:text-3xl font-semibold text-blue-600 mb-6">ç¡®ä¿è”é‚¦å­¦ä¹ è®¾å¤‡çš„å®æ—¶åœ¨çº¿çŠ¶æ€</h2>
            <p class="max-w-3xl mx-auto text-lg text-slate-600">
                æ¢ç´¢å¦‚ä½•åˆ©ç”¨ MQTT åè®®ï¼Œé«˜æ•ˆä¸”å¯é åœ°ç®¡ç†è”é‚¦å­¦ä¹ ä¸­çš„è¾¹ç¼˜è®¾å¤‡ï¼ˆAndroid/iOSï¼‰çš„æ³¨å†Œã€åœ¨çº¿å¿ƒè·³å’Œç¦»çº¿æ£€æµ‹ã€‚
            </p>
        </section>

        <section id="why-mqtt" class="mb-20">
            <h3 class="text-3xl font-bold text-center mb-12 text-slate-800">ä¸ºä»€ä¹ˆé€‰æ‹© MQTTï¼Ÿ</h3>
            <p class="text-center text-slate-600 max-w-3xl mx-auto mb-10">
                MQTT (Message Queuing Telemetry Transport) æ˜¯ä¸€ç§è½»é‡çº§çš„å‘å¸ƒ/è®¢é˜…æ¶ˆæ¯åè®®ï¼Œä¸“ä¸ºä½å¸¦å®½ã€é«˜å»¶è¿Ÿæˆ–ä¸å¯é ç½‘ç»œç¯å¢ƒä¸‹çš„ç‰©è”ç½‘è®¾å¤‡è®¾è®¡ã€‚è¿™ä½¿å…¶æˆä¸ºç®¡ç†è¾¹ç¼˜è®¾å¤‡è¿æ¥çš„ç†æƒ³é€‰æ‹©ã€‚
            </p>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-teal-500">
                    <h4 class="text-xl font-bold mb-3 text-teal-700">ğŸš€ è½»é‡ä¸é«˜æ•ˆ</h4>
                    <p class="text-slate-600">åè®®å¼€é”€å°ï¼Œé€‚åˆèµ„æºå—é™çš„ç§»åŠ¨/è¾¹ç¼˜è®¾å¤‡å’Œå¼±ç½‘ç»œç¯å¢ƒã€‚</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-blue-500">
                    <h4 class="text-xl font-bold mb-3 text-blue-700">ğŸ”„ å‘å¸ƒ/è®¢é˜…æ¨¡å¼</h4>
                    <p class="text-slate-600">åç«¯å¯çµæ´»è®¢é˜…è®¾å¤‡çŠ¶æ€ä¸»é¢˜ï¼Œæ— éœ€é¢‘ç¹è½®è¯¢ï¼Œå®ç°äº‹ä»¶é©±åŠ¨ã€‚</p>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-amber-500">
                    <h4 class="text-xl font-bold mb-3 text-amber-700">ğŸ’” é—å˜±æ¶ˆæ¯ (LWT)</h4>
                    <p class="text-slate-600">è®¾å¤‡éæ­£å¸¸æ–­å¼€è¿æ¥æ—¶ï¼ŒBroker è‡ªåŠ¨å‘å¸ƒç¦»çº¿é€šçŸ¥ï¼Œå®ç°å³æ—¶ç¦»çº¿æ£€æµ‹ã€‚</p>
                </div>
            </div>
        </section>

        <section id="interactive-flow" class="mb-20">
            <h3 class="text-3xl font-bold text-center mb-12 text-slate-800">è®¾å¤‡æ³¨å†Œä¸å¿ƒè·³äº¤äº’æµç¨‹</h3>

            <div class="flex flex-col lg:flex-row items-center justify-center space-y-8 lg:space-y-0 lg:space-x-8">
                <!-- Edge Device -->
                <div class="flex flex-col items-center w-full lg:w-1/3">
                    <div class="flow-entity-header text-green-700">è¾¹ç¼˜è®¾å¤‡ (Android/iOS)</div>
                    <div id="step-device-register" class="flow-step-card w-full">
                        <span class="step-number">1</span>
                        <h4 class="text-lg font-semibold text-slate-800">è®¾å¤‡é¦–æ¬¡è¿æ¥ä¸æ³¨å†Œ</h4>
                        <p class="mt-2 text-slate-600">è®¾å¤‡å‘ API ç½‘å…³å‘èµ·æ³¨å†Œè¯·æ±‚ï¼Œè·å–è®¤è¯å‡­è¯ã€‚</p>
                    </div>
                    <div class="flow-arrow-down lg:hidden">â†“</div>
                </div>

                <!-- API Gateway -->
                <div class="hidden lg:flex flex-col items-center justify-center w-12 h-40">
                    <div class="flow-arrow-right">â†’</div>
                </div>
                <div class="flex flex-col items-center w-full lg:w-1/3">
                    <div class="flow-entity-header text-purple-700">API ç½‘å…³ / æ³¨å†ŒæœåŠ¡</div>
                    <div id="step-mqtt-connect" class="flow-step-card w-full">
                        <span class="step-number">2</span>
                        <h4 class="text-lg font-semibold text-slate-800">MQTT è¿æ¥å»ºç«‹ä¸é—å˜±è®¾ç½®</h4>
                        <p class="mt-2 text-slate-600">è®¾å¤‡ä½¿ç”¨ MQTT å®¢æˆ·ç«¯åº“è¿æ¥ Brokerï¼Œé…ç½®é—å˜±æ¶ˆæ¯ (LWT)ã€‚</p>
                    </div>
                    <div class="flow-arrow-down lg:hidden">â†“</div>
                </div>

                <!-- MQTT Broker -->
                <div class="hidden lg:flex flex-col items-center justify-center w-12 h-40">
                    <div class="flow-arrow-right">â†’</div>
                </div>
                <div class="flex flex-col items-center w-full lg:w-1/3">
                    <div class="flow-entity-header text-blue-700">MQTT Broker</div>
                    <div id="step-heartbeat-publish" class="flow-step-card w-full">
                        <span class="step-number">3</span>
                        <h4 class="text-lg font-semibold text-slate-800">å¿ƒè·³æ¶ˆæ¯å‘å¸ƒ</h4>
                        <p class="mt-2 text-slate-600">è®¾å¤‡å®šæœŸå‘ Broker å‘å¸ƒè½»é‡çº§å¿ƒè·³æ¶ˆæ¯ã€‚</p>
                    </div>
                    <div class="flow-arrow-down lg:hidden">â†“</div>
                </div>
            </div>

            <!-- Second row of flow (for subscription) -->
            <div class="flex flex-col lg:flex-row items-center justify-center space-y-8 lg:space-y-0 lg:space-x-8 mt-8">
                 <div class="hidden lg:flex flex-col items-center w-1/3"></div> <!-- Placeholder to align -->
                 <div class="hidden lg:flex flex-col items-center justify-center w-12 h-40">
                    <div class="flow-arrow-right transform rotate-180">â†’</div> <!-- Arrow pointing left -->
                 </div>
                <!-- Backend Service / Aggregator -->
                <div class="flex flex-col items-center w-full lg:w-1/3">
                    <div class="flow-entity-header text-red-700">åç«¯æœåŠ¡ / èšåˆæœåŠ¡å™¨</div>
                    <div id="step-backend-subscribe" class="flow-step-card w-full">
                        <span class="step-number">4</span>
                        <h4 class="text-lg font-semibold text-slate-800">åç«¯æœåŠ¡è®¢é˜…ä¸çŠ¶æ€æ›´æ–°</h4>
                        <p class="mt-2 text-slate-600">åç«¯è®¢é˜…å¿ƒè·³/LWT ä¸»é¢˜ï¼Œå®æ—¶æ›´æ–°è®¾å¤‡åœ¨çº¿çŠ¶æ€ã€‚</p>
                    </div>
                    <div class="flow-arrow-down lg:hidden">â†“</div>
                </div>

                <div class="hidden lg:flex flex-col items-center justify-center w-12 h-40">
                     <div class="flow-arrow-right transform rotate-180">â†’</div> <!-- Placeholder arrow to align -->
                </div>
                <div class="hidden lg:flex flex-col items-center w-1/3"></div> <!-- Placeholder to align -->
            </div>


            <div id="details-panel" class="details-panel mt-12 bg-white p-8 rounded-xl shadow-xl border border-slate-200">
                <h4 id="details-title" class="text-2xl font-bold mb-4 text-blue-700"></h4>
                <div id="details-content" class="prose max-w-none text-slate-700"></div>
            </div>
        </section>

        <section id="component-roles" class="mb-20">
            <h3 class="text-3xl font-bold text-center mb-12 text-slate-800">å„ç»„ä»¶åœ¨ MQTT ç®¡ç†ä¸­çš„èŒè´£</h3>
            <div class="grid grid-cols-1 md:grid-cols-3 gap-8">
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-green-500">
                    <h4 class="text-xl font-bold mb-3 text-green-700">è¾¹ç¼˜è®¾å¤‡</h4>
                    <ul class="list-disc list-inside space-y-2 text-slate-600">
                        <li>å‘èµ·æ³¨å†Œï¼Œè·å–è®¤è¯ä¿¡æ¯ã€‚</li>
                        <li>ä½¿ç”¨ MQTT å®¢æˆ·ç«¯è¿æ¥ Brokerã€‚</li>
                        <li>é…ç½®å¹¶å‘é€ LWT æ¶ˆæ¯ã€‚</li>
                        <li>å®šæœŸå‘å¸ƒå¿ƒè·³æ¶ˆæ¯åˆ°æŒ‡å®šä¸»é¢˜ã€‚</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-purple-500">
                    <h4 class="text-xl font-bold mb-3 text-purple-700">API ç½‘å…³ / æ³¨å†ŒæœåŠ¡</h4>
                    <ul class="list-disc list-inside space-y-2 text-slate-600">
                        <li>å¤„ç†è®¾å¤‡çš„é¦–æ¬¡è®¤è¯ä¸æ³¨å†Œè¯·æ±‚ã€‚</li>
                        <li>åˆ†å‘ MQTT è¿æ¥å‡­è¯ã€‚</li>
                        <li>ï¼ˆå¯é€‰ï¼‰å°†æ³¨å†ŒæˆåŠŸä¿¡æ¯è½¬å‘ç»™åç«¯ã€‚</li>
                    </ul>
                </div>
                <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-blue-500">
                    <h4 class="text-xl font-bold mb-3 text-blue-700">MQTT Broker</h4>
                    <ul class="list-disc list-inside space-y-2 text-slate-600">
                        <li>ç®¡ç†è®¾å¤‡è¿æ¥ä¸ä¼šè¯ã€‚</li>
                        <li>æ¥æ”¶ã€å­˜å‚¨å¹¶åˆ†å‘å¿ƒè·³æ¶ˆæ¯ã€‚</li>
                        <li>åœ¨è®¾å¤‡éæ­£å¸¸æ–­å¼€æ—¶ï¼Œè‡ªåŠ¨å‘å¸ƒ LWT æ¶ˆæ¯ã€‚</li>
                    </ul>
                </div>
                 <div class="bg-white p-6 rounded-lg shadow-lg border-t-4 border-red-500 md:col-span-3 lg:col-span-1 mx-auto w-full md:w-auto">
                    <h4 class="text-xl font-bold mb-3 text-red-700">åç«¯æœåŠ¡ / èšåˆæœåŠ¡å™¨</h4>
                    <ul class="list-disc list-inside space-y-2 text-slate-600">
                        <li>è®¢é˜… MQTT å¿ƒè·³åŠçŠ¶æ€ä¸»é¢˜ã€‚</li>
                        <li>å®æ—¶æ›´æ–°è®¾å¤‡åœ¨çº¿çŠ¶æ€å’Œå¥åº·ä¿¡æ¯ã€‚</li>
                        <li>æ ¹æ®è®¾å¤‡çŠ¶æ€è¿›è¡Œè”é‚¦å­¦ä¹ ä»»åŠ¡è°ƒåº¦ã€‚</li>
                        <li>å¤„ç†é—å˜±æ¶ˆæ¯ï¼Œå¿«é€Ÿè¯†åˆ«ç¦»çº¿è®¾å¤‡ã€‚</li>
                    </ul>
                </div>
            </div>
        </section>

        <section id="benefits-chart">
            <h3 class="text-3xl font-bold text-center mb-12 text-slate-800">MQTT åœ¨è®¾å¤‡ç®¡ç†ä¸­çš„ä¸»è¦ä¼˜åŠ¿</h3>
            <div class="bg-white p-8 rounded-lg shadow-lg max-w-md mx-auto">
                <p class="text-center text-slate-600 mb-6">MQTT åè®®çš„ç‰¹æ€§ä½¿å…¶æˆä¸ºè”é‚¦å­¦ä¹ è¾¹ç¼˜è®¾å¤‡ç®¡ç†çš„é«˜æ•ˆä¸”å¯é é€‰æ‹©ã€‚</p>
                <div class="h-80 w-full mx-auto chart-container">
                    <canvas id="benefitsChart"></canvas>
                </div>
            </div>
        </section>

    </main>

    <script>
        const detailsData = {
            "step-device-register": {
                title: "ç¬¬ 1 æ­¥ï¼šè®¾å¤‡é¦–æ¬¡è¿æ¥ä¸æ³¨å†Œ",
                content: `
                    <p>å½“è¾¹ç¼˜è®¾å¤‡ï¼ˆä¾‹å¦‚ä¸€éƒ¨ Android æˆ– iOS æ‰‹æœºï¼‰é¦–æ¬¡å¯åŠ¨å¹¶éœ€è¦åŠ å…¥è”é‚¦å­¦ä¹ ç½‘ç»œæ—¶ï¼Œå®ƒä¼šå‘åç«¯çš„ <strong>API ç½‘å…³æˆ–ä¸“é—¨çš„æ³¨å†ŒæœåŠ¡</strong>å‘èµ·è¯·æ±‚ã€‚</p>
                    <p class="mt-2">æ­¤è¯·æ±‚é€šå¸¸åŒ…å«è®¾å¤‡çš„å”¯ä¸€æ ‡è¯†ã€ç±»å‹ã€ç‰ˆæœ¬ç­‰ä¿¡æ¯ï¼Œå¹¶å¯èƒ½éœ€è¦è¿›è¡Œèº«ä»½è®¤è¯ã€‚æ³¨å†ŒæˆåŠŸåï¼Œè®¾å¤‡å°†è·å¾—å‚ä¸åç»­é€šä¿¡ï¼ˆåŒ…æ‹¬ MQTT è¿æ¥ï¼‰æ‰€éœ€çš„<strong>è®¤è¯å‡­è¯</strong>æˆ– Tokenã€‚</p>
                    <p class="mt-4 font-semibold">ç›¸å…³ç»„ä»¶èŒè´£:</p>
                    <ul class="list-disc list-inside">
                        <li><strong>è¾¹ç¼˜è®¾å¤‡:</strong> å‘èµ·æ³¨å†Œè¯·æ±‚ï¼Œæ¥æ”¶å¹¶å­˜å‚¨å‡­è¯ã€‚</li>
                        <li><strong>API ç½‘å…³/æ³¨å†ŒæœåŠ¡:</strong> éªŒè¯è®¾å¤‡èº«ä»½ï¼Œå¤„ç†æ³¨å†Œé€»è¾‘ï¼Œåˆ†å‘å‡­è¯ã€‚</li>
                    </ul>
                `
            },
            "step-mqtt-connect": {
                title: "ç¬¬ 2 æ­¥ï¼šMQTT è¿æ¥å»ºç«‹ä¸é—å˜±è®¾ç½®",
                content: `
                    <p>è®¾å¤‡æ³¨å†ŒæˆåŠŸå¹¶è·å–åˆ°å¿…è¦å‡­è¯åï¼Œä¼šä½¿ç”¨<strong>MQTT å®¢æˆ·ç«¯åº“</strong>ï¼ˆå¦‚ Paho MQTTï¼‰ä¸éƒ¨ç½²çš„ <strong>MQTT Broker</strong> å»ºç«‹é•¿è¿æ¥ã€‚è¿™æ˜¯ä¸€ä¸ªåŸºäº TCP/IP çš„æŒä¹…è¿æ¥ï¼Œæ˜¯åç»­å¿ƒè·³å’Œæ¶ˆæ¯ä¼ è¾“çš„åŸºç¡€ã€‚</p>
                    <p class="mt-2">åœ¨è¿æ¥å»ºç«‹æ—¶ï¼Œè®¾å¤‡ä¼šé…ç½®ä¸€ä¸ªé‡è¦çš„ç‰¹æ€§ï¼š<strong>é—å˜±æ¶ˆæ¯ (Last Will and Testament - LWT)</strong>ã€‚è®¾å¤‡ä¼šæŒ‡å®šä¸€ä¸ª LWT ä¸»é¢˜ï¼ˆä¾‹å¦‚ <code>/devices/&lt;device_id&gt;/status</code>ï¼‰å’Œä¸€æ¡æ¶ˆæ¯ï¼ˆä¾‹å¦‚ <code>offline</code>ï¼‰ã€‚å¦‚æœè®¾å¤‡éæ­£å¸¸æ–­å¼€è¿æ¥ï¼ŒMQTT Broker å°†è‡ªåŠ¨å‘è¯¥ä¸»é¢˜å‘å¸ƒè¿™æ¡é—å˜±æ¶ˆæ¯ï¼Œé€šçŸ¥æ‰€æœ‰è®¢é˜…è€…è¯¥è®¾å¤‡å·²ç¦»çº¿ã€‚</p>
                    <p class="mt-4 font-semibold">ç›¸å…³ç»„ä»¶èŒè´£:</p>
                    <ul class="list-disc list-inside">
                        <li><strong>è¾¹ç¼˜è®¾å¤‡:</strong> å»ºç«‹ MQTT è¿æ¥ï¼Œè®¾ç½® LWTã€‚</li>
                        <li><strong>MQTT Broker:</strong> æ¥å—è¿æ¥ï¼Œç»´æŠ¤ä¼šè¯ï¼Œå¹¶åœ¨å¿…è¦æ—¶å‘å¸ƒ LWTã€‚</li>
                    </ul>
                `
            },
            "step-heartbeat-publish": {
                title: "ç¬¬ 3 æ­¥ï¼šå¿ƒè·³æ¶ˆæ¯å‘å¸ƒ",
                content: `
                    <p>ä¸€æ—¦ MQTT è¿æ¥å»ºç«‹å¹¶ç¨³å®šï¼Œè¾¹ç¼˜è®¾å¤‡å°†å¼€å§‹å®šæœŸå‘ <strong>MQTT Broker</strong> å‘å¸ƒå¿ƒè·³æ¶ˆæ¯ã€‚è¿™äº›æ¶ˆæ¯éå¸¸è½»é‡ï¼Œé€šå¸¸åªåŒ…å«è®¾å¤‡ ID å’Œä¸€ä¸ªæ—¶é—´æˆ³ï¼Œå‘å¸ƒåˆ°é¢„å®šä¹‰çš„å¿ƒè·³ä¸»é¢˜ï¼ˆä¾‹å¦‚ <code>/devices/&lt;device_id&gt;/heartbeat</code>ï¼‰ã€‚</p>
                    <p class="mt-2">å¿ƒè·³çš„é¢‘ç‡å¯ä»¥æ ¹æ®éœ€æ±‚å’Œè®¾å¤‡èµ„æºè¿›è¡Œè°ƒæ•´ï¼ˆä¾‹å¦‚æ¯ 30 ç§’æˆ–æ¯åˆ†é’Ÿä¸€æ¬¡ï¼‰ã€‚å®ƒçš„ä¸»è¦ç›®çš„æ˜¯ä¸»åŠ¨å‘ŠçŸ¥åç«¯æœåŠ¡è®¾å¤‡ä»ç„¶åœ¨çº¿ä¸”æ´»è·ƒã€‚</p>
                    <p class="mt-4 font-semibold">ç›¸å…³ç»„ä»¶èŒè´£:</p>
                    <ul class="list-disc list-inside">
                        <li><strong>è¾¹ç¼˜è®¾å¤‡:</strong> å®šæœŸæ„å»ºå¹¶å‘å¸ƒå¿ƒè·³æ¶ˆæ¯ã€‚</li>
                        <li><strong>MQTT Broker:</strong> æ¥æ”¶å¿ƒè·³æ¶ˆæ¯ï¼Œå¹¶å°†å…¶åˆ†å‘ç»™æ‰€æœ‰è®¢é˜…äº†ç›¸åº”ä¸»é¢˜çš„åç«¯æœåŠ¡ã€‚</li>
                    </ul>
                `
            },
            "step-backend-subscribe": {
                title: "ç¬¬ 4 æ­¥ï¼šåç«¯æœåŠ¡è®¢é˜…ä¸çŠ¶æ€æ›´æ–°",
                content: `
                    <p>ä¸ºäº†å®æ—¶ç›‘æ§è¾¹ç¼˜è®¾å¤‡çš„åœ¨çº¿çŠ¶æ€ï¼Œ<strong>åç«¯æœåŠ¡</strong>ï¼ˆä¾‹å¦‚è®¾å¤‡ç®¡ç†æœåŠ¡ï¼Œæˆ–ç›´æ¥ä¸èšåˆæœåŠ¡å™¨é›†æˆçš„æœåŠ¡ï¼‰ä¼šè®¢é˜… <strong>MQTT Broker</strong> ä¸Šçš„å¿ƒè·³ä¸»é¢˜å’Œé—å˜±ä¸»é¢˜ï¼ˆä¾‹å¦‚ <code>/devices/+/heartbeat</code> å’Œ <code>/devices/+/status</code>ï¼‰ã€‚</p>
                    <p class="mt-2">å½“æ”¶åˆ°å¿ƒè·³æ¶ˆæ¯æ—¶ï¼Œåç«¯æœåŠ¡ä¼šæ›´æ–°è®¾å¤‡åœ¨æ•°æ®åº“ä¸­çš„â€œåœ¨çº¿â€çŠ¶æ€å’Œâ€œæœ€åæ´»è·ƒæ—¶é—´â€ã€‚å½“æ”¶åˆ°é—å˜±æ¶ˆæ¯æ—¶ï¼Œåç«¯æœåŠ¡ä¼šç«‹å³å°†è®¾å¤‡çŠ¶æ€æ ‡è®°ä¸ºâ€œç¦»çº¿â€æˆ–â€œå¼‚å¸¸â€ã€‚</p>
                    <p class="mt-2">è¿™äº›å®æ—¶æ›´æ–°çš„è®¾å¤‡çŠ¶æ€ä¿¡æ¯å¯¹äºè”é‚¦å­¦ä¹ çš„<strong>è®­ç»ƒè°ƒåº¦</strong>è‡³å…³é‡è¦ï¼šèšåˆæœåŠ¡å™¨å¯ä»¥æ ¹æ®è¿™äº›ä¿¡æ¯ï¼Œé€‰æ‹©å½“å‰åœ¨çº¿ä¸”å¥åº·çš„è®¾å¤‡å‚ä¸è®­ç»ƒã€‚</p>
                    <p class="mt-4 font-semibold">ç›¸å…³ç»„ä»¶èŒè´£:</p>
                    <ul class="list-disc list-inside">
                        <li><strong>åç«¯æœåŠ¡/èšåˆæœåŠ¡å™¨:</strong> è®¢é˜… MQTT ä¸»é¢˜ï¼Œå®æ—¶å¤„ç†æ¥æ”¶åˆ°çš„æ¶ˆæ¯ï¼Œæ›´æ–°è®¾å¤‡çŠ¶æ€ã€‚</li>
                        <li><strong>MQTT Broker:</strong> å°†å¿ƒè·³å’Œ LWT æ¶ˆæ¯åˆ†å‘ç»™è®¢é˜…çš„åç«¯æœåŠ¡ã€‚</li>
                    </ul>
                `
            }
        };

        const steps = document.querySelectorAll('.flow-step-card');
        const detailsPanel = document.getElementById('details-panel');
        const detailsTitle = document.getElementById('details-title');
        const detailsContent = document.getElementById('details-content');
        let activeStep = null;

        steps.forEach(step => {
            step.addEventListener('click', () => {
                const stepId = step.id;

                if (activeStep) {
                    activeStep.classList.remove('active');
                }

                if (activeStep === step) {
                    detailsPanel.classList.remove('show');
                    activeStep = null;
                } else {
                    step.classList.add('active');
                    activeStep = step;

                    detailsTitle.textContent = detailsData[stepId].title;
                    detailsContent.innerHTML = detailsData[stepId].content;
                    detailsPanel.classList.add('show');
                }
            });
        });

        const benefitsCtx = document.getElementById('benefitsChart').getContext('2d');
        const benefitsLabels = [
            'è½»é‡é«˜æ•ˆ',
            'å®æ—¶åœ¨çº¿æ„ŸçŸ¥',
            'èµ„æºèŠ‚çº¦',
            'å¿«é€Ÿç¦»çº¿æ£€æµ‹',
            ['è®­ç»ƒè°ƒåº¦', 'ä¼˜åŒ–']
        ];

        const tooltipTitleCallback = (tooltipItems) => {
            const item = tooltipItems[0];
            let label = item.chart.data.labels[item.dataIndex];
            if (Array.isArray(label)) {
                return label.join(' ');
            }
            return label;
        };

        new Chart(benefitsCtx, {
            type: 'doughnut',
            data: {
                labels: benefitsLabels,
                datasets: [{
                    label: 'MQTT åœ¨è®¾å¤‡ç®¡ç†ä¸­çš„ä¼˜åŠ¿',
                    data: [20, 20, 15, 25, 20], /* Example distribution */
                    backgroundColor: [
                        '#2563eb', /* blue-600 */
                        '#f59e0b', /* amber-500 */
                        '#0d9488', /* teal-600 */
                        '#ef4444', /* red-500 */
                        '#6d28d9'  /* violet-700 */
                    ],
                    borderColor: '#f8fafc',
                    borderWidth: 4,
                    hoverOffset: 8
                }]
            },
            options: {
                responsive: true,
                maintainAspectRatio: false,
                plugins: {
                    legend: {
                        position: 'bottom',
                        labels: {
                            font: {
                                size: 14,
                                family: "'Noto Sans SC', sans-serif"
                            },
                            padding: 20,
                            generateLabels: function(chart) {
                                const data = chart.data;
                                return data.labels.map((label, i) => {
                                    const meta = chart.getDatasetMeta(0);
                                    const style = data.datasets[0].backgroundColor[i];
                                    return {
                                        text: Array.isArray(label) ? label.join(' ') : label,
                                        fillStyle: style,
                                        strokeStyle: data.datasets[0].borderColor,
                                        lineWidth: data.datasets[0].borderWidth,
                                        hidden: isNaN(meta.data[i].parsed),
                                        index: i
                                    };
                                });
                            }
                        }
                    },
                    tooltip: {
                        callbacks: {
                            title: tooltipTitleCallback,
                            label: function(context) {
                                let label = context.label || '';
                                if (label) {
                                    label += ': ';
                                }
                                if (context.parsed !== null) {
                                    label += context.parsed + '%';
                                }
                                return label;
                            }
                        }
                    }
                },
                cutout: '60%'
            }
        });
    </script>

</body>
</html>
